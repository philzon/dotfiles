#!/bin/bash

if [ -z "$FILE" ]
then
	FILE=".history"
fi

touch "$FILE"

if [ $# -eq 0 ]
then
	exit 0
fi

DATE=$(date +"%T")
start=$SECONDS

$@

CODE=$?

DURATION="$(( SECONDS - start ))"

if (( $DURATION < 60 ))
then
	DURATION="${DURATION}s"
elif (( $DURATION < 3600 ))
then
	DURATION="$(( $DURATION / 60 ))m"
else
	DURATION="$(( $DURATION / 3600 ))h"
fi

DATA=$(cat "$FILE")

echo "$CODE $DATE [$DURATION] $@" > "$FILE"
echo "$DATA" >> "$FILE"
